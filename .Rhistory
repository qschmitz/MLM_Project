source('E:/Universite de Genève/Faculté d\'économie/Mon Master en statistique/A1S1/Mixed Linear Models/DATA exam/MLM_Project/Fun.R', echo=TRUE)
Chemo = read.table(file="Chemotherapy-version1.csv")
head(Chemo);last(Chemo);plot(Chemo);View(Chemo)
Chemo = read.table(file="Chemotherapy-version1.csv",header=TRUE,sep=",")
head(Chemo);last(Chemo);plot(Chemo);View(Chemo)
#check data type
sapply(Chemo, class)
Chemo[,3:4]
Chemo = lapply(Chemo[,3:4], as.factor)
sapply(Chemo, class)#line/month should be factor
#check data type
sapply(Chemo, class)#line/month should be factor
#playing hard to get?...precise "sep" or get wrecked
Chemo = read.table(file="Chemotherapy-version1.csv",header=TRUE,sep=",")
#check data type
sapply(Chemo, class)#line/month should be factor
Metal[,"line"] <- as.factor(Metal[,"line"])
Chemo[,"line"] <- as.factor(Chemo[,"line"])
#check data type
sapply(Chemo, class)#line/month should be factor
Chemo[,"month"] <- as.factor(Chemo[,"month"])
#check data type
sapply(Chemo, class)#line/month should be factor
Chemo[,3:4]
Chemo = lapply(Chemo[,3:4], as.factor)
#check data type
sapply(Chemo, class)#line/month should be factor
Chemo[,"line"] <- as.factor(Chemo[,"line"])
Chemo[,"month"] <- as.factor(Chemo[,"month"])
Chemo = lapply(Chemo[,3:4], as.factor)
View(Chemo)
#playing hard to get?...precise "sep" or get wrecked
Chemo = read.table(file="Chemotherapy-version1.csv",header=TRUE,sep=",")
Chemo[,3:4] = lapply(Chemo[,3:4], as.factor)
#check data type
sapply(Chemo, class)#line/month should be factor
sapply(Chemo)
sapply(Chemom,class)
sapply(Chemo,class)
#setting contrasts
contrasts(Chemo$patient)
contrasts(Chemo$month)
head(Chemo);last(Chemo);View(Chemo)
head(Chemo);View(Chemo);length(Chemo[,1])
count(Chemo[,1])#
Chemo[,1] %>% count(patient)
137/19
137/18
#setting contrasts for F.E. line, month, sensitivity
contrasts(Chemo$line)="contr.sum"
contrasts(Chemo$month)="contr.sum"
contrasts(Chemo$sensitivity)="contr.sum"
contrasts(Chemo$line)
contrasts(Chemo$month)
attach(Chemo)
#setting model
lmer_Chemo = lmer(tumour~line*sensitivity+(month|patient))
lme_Chemo = lme(fixed=tumour~line*sensitivity, random=month|patient, method="ML")
#setting model
lmer_Chemo = lmer(tumour~line*sensitivity+(month|patient),data=Chemo)
lme_Chemo = lme(fixed=tumour~line*sensitivity, random=month|patient,data=Chemo, method="ML")
#The Greatest summary of all times
#librairies
library(scales)#This library allows to control the nuance of colors with the function alpha()
library(nlme) #Groupdata
library(lmerTest)
library(MuMIn)
library(pbkrtest)
library(car)
library(mvtnorm)
library(dplyr)
#data
Electrode=read.table(file="Electrode.txt",header=T)
df = read.table(file="Fat.txt",header=T)
Mouse.dat <- read.csv(file="Mice.csv",header=T,sep=";")
Metal <- read.table("Metal.txt", header=T)
Poverty <- read.table("Poverty.txt", header=T)
Semantic = read.table("Semantic.txt",header=T)
semantic = read.table("Semantic.txt",header=T)
orth <- read.table("Orth.txt", header=T)
#data
setwd(dir.choose())
getwd()
#data
setwd(setwd("E:/Universite de Genève/Faculté d'économie/Mon Master en statistique/A1S1/Mixed Linear Models/Practicals"))
Electrode=read.table(file="Electrode.txt",header=T)
df = read.table(file="Fat.txt",header=T)
#data
setwd("E:/Universite de Genève/Faculté d'économie/Mon Master en statistique/A1S1/Mixed Linear Models/Practicals")
Electrode=read.table(file="Electrode.txt",header=T)
df = read.table(file="Fat.txt",header=T)
Mouse.dat <- read.csv(file="Mice.csv",header=T,sep=";")
Metal <- read.table("Metal.txt", header=T)
Poverty <- read.table("Poverty.txt", header=T)
Semantic = read.table("Semantic.txt",header=T)
semantic = read.table("Semantic.txt",header=T)
orth <- read.table("Orth.txt", header=T)
#changing data type
sapply(Metal,class)#check data
Metal[,"Lots"] <- as.factor(Metal[,"Lots"]) #change data
Poverty[,"Subject"] <- as.factor(Poverty[,"Subject"])
#even quicker
Electrode[,2:3] <- lapply(Electrode[,2:3], as.factor)
orth[,3:4] <- lapply(orth[,3:4], as.factor)
Poverty[,2:4] <- lapply(Poverty[,2:4], as.factor)
#Choose your contrasts
contrasts(Metal$Type) <- "contr.sum"
X <- model.matrix(~Metal$Type);X
contrasts(Metal$Type) <- "contr.treatment"
X <- model.matrix(~Metal$Type);X
#fitting models
fit.lmer.reml = lmer(Response~Type+(1|Lots/Sample/Chemist),data=Metal)
sapply(Semantic,factor)
sapply(Semantic,class)
sapply(orth,class)
sapply(Metal,class)
#What are we dealing with
Chemo = read.table(file="Chemotherapy-version1.csv",header=TRUE,sep=",")
setwd("E:/Universite de Genève/Faculté d'économie/Mon Master en statistique/A1S1/Mixed Linear Models/DATA exam/MLM_Project")
#What are we dealing with
Chemo = read.table(file="Chemotherapy-version1.csv",header=TRUE,sep=",")
attach(Chemo)
#check data type
sapply(Chemo, class)#line should be factor
Chemo[,"line"] <- as.factor(Chemo[,"line"]);
#setting contrasts sum for line, month: there is not a reference line or month, so sum contrasts
contrasts(Chemo$line)="contr.sum"
contrasts(Chemo$month)="contr.sum"
#setting model
lmer_Chemo = lmer(tumour~line*sensitivity+(month|patient),data=Chemo)
lme_Chemo = lme(fixed=tumour~line*sensitivity, random=month|patient,data=Chemo, method="ML")
#check data type
sapply(Chemo, class)#line should be factor
#setting model
lmer_Chemo = lmer(tumour~line*sensitivity+(month|patient),data=Chemo)
lme_Chemo = lme(fixed=tumour~line*sensitivity, random=month|patient,data=Chemo, method="ML")
?isSingular
#setting model
lmer_Chemo = lmer(tumour~line*sensitivity+month+(1|patient),data=Chemo)
lme_Chemo = lme(fixed=tumour~line*sensitivity+month, random=1|patient,data=Chemo, method="ML")
lme_Chemo = lme(fixed=tumour~line*sensitivity, random=1|patient,data=Chemo, method="ML")
lme_Chemo = lme(fixed=tumour~line*sensitivity+month, random=1|month,data=Chemo, method="ML")
lme_Chemo = lme(fixed=tumour~line*sensitivity+month, random=~1|patient,data=Chemo, method="ML")
#study data with plots
#Boxplots: use it for heteroskedasticity, distribution
boxplot(tumour~patient)
#Plot design: shows variability of your factors, i.e. heteroskedasticity
plot.design(tumour~.)
#Plot design: shows variability of your factors, i.e. heteroskedasticity
plot.design(tumour~.,data=Chemo)
plot.design(patient~.,data=Chemo)
plot.design(Chemo)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(sensitivity,month)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(tumour,month)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(tumour,month,sensitivity)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(sensitivity,month,tumour)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(month,sensitivity,tumour)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(line,sensitivity,tumour)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(sensitivity,line,tumour)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(Metal$Chemist,Metal$Type,Metal$Response)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(sensitivity,month,tumour)
View(month)
interaction.plot(month,sensitivity,tumour)
interaction.plot(month,patient,tumour)
#Interaction plot: does one marginal effect depend on its relative position on the characteristics space?
interaction.plot(sensitivity,month,tumour)
interaction.plot(month,sensitivity,tumour)#
interaction.plot(month,patient,tumour)
interaction.plot(sensitivity,patient,tumour)
interaction.plot(patient,sensitivity,tumour)
interaction.plot(month,line,tumour)
interaction.plot(line,sensitivity,tumour)
interaction.plot(sensitivity,line,tumour)
interaction.plot(patient,line,tumour)
interaction.plot(line,patient,tumour)
interaction.plot(month,line,tumour)#HA-HAAAAA MONTH HAS AN INTERACTION WITH LINE
